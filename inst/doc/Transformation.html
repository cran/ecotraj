<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Miquel De Cáceres" />

<meta name="date" content="2022-04-26" />

<title>Transformation of dissimilarities in community data</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Transformation of dissimilarities in community data</h1>
<h4 class="author">Miquel De Cáceres</h4>
<h4 class="date">2022-04-26</h4>


<div id="TOC">
<ul>
<li><a href="#introduction">1. Introduction</a></li>
<li><a href="#effect-of-square-root-on-a-simple-directional-trajectory">2. Effect of square root on a simple directional trajectory</a></li>
<li><a href="#effect-of-different-transformations-on-more-complex-trajectories">3. Effect of different transformations on more complex trajectories</a></li>
<li><a href="#conclusions">4. Conclusions</a></li>
</ul>
</div>

<div id="introduction" class="section level2">
<h2>1. Introduction</h2>
<p>Some dissimilarity coefficients that are popular in community ecology, such as the percentage difference (alias Bray-Curtis), have the drawback of being a non-Euclidean (dissimilarity matrices do not allow a representation in a Cartesian space), or even semi-metric (i.e. triangle inequality is not ensured). In order to use these coefficients in multivariate analyses that require these properties a transformation of the original space will normally be in order. In this section, we compare different alternatives and provide some recommendations on this issue.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ecotraj)</span></code></pre></div>
</div>
<div id="effect-of-square-root-on-a-simple-directional-trajectory" class="section level2">
<h2>2. Effect of square root on a simple directional trajectory</h2>
<p>Here, we use an example of a single synthetic community to illustrate the effect of square root transformation on a community trajectory. We begin by defining the species data of the trajectory itself. The dataset consists of four rows (i.e. surveys) and four columns (species). The dynamics in this example consist in an constant increase in the number of individuals of the first species and a corresponding decrease of the others, while keeping a total abundance of 100 individuals:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>sites <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">4</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>surveys<span class="ot">=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>spdata <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">35</span>,<span class="dv">30</span>,<span class="dv">20</span>,<span class="dv">15</span>),</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>               <span class="fu">c</span>(<span class="dv">50</span>,<span class="dv">25</span>,<span class="dv">15</span>,<span class="dv">10</span>),</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>               <span class="fu">c</span>(<span class="dv">65</span>,<span class="dv">20</span>,<span class="dv">10</span>,<span class="dv">5</span>),</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>               <span class="fu">c</span>(<span class="dv">80</span>,<span class="dv">15</span>,<span class="dv">5</span>,<span class="dv">0</span>))</span></code></pre></div>
<p>We now use function <code>vegdist</code> from package <code>vegan</code> to calculate the Bray-Curtis coefficient:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>D <span class="ot">=</span> vegan<span class="sc">::</span><span class="fu">vegdist</span>(spdata, <span class="st">&quot;bray&quot;</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">is.metric</span>(D)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>D</span></code></pre></div>
<pre><code>##      1    2    3
## 2 0.15          
## 3 0.30 0.15     
## 4 0.45 0.30 0.15</code></pre>
<p>This dissimilarity matrix is a metric, so one would not need any transformation for CTA. However, it is a good example to illustrate the effect of the square root transformation.</p>
<p>If we draw the resemblance space corresponding to this dissimilarity matrix we see a straight trajectory:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">trajectoryPCoA</span>(D,sites,surveys, <span class="at">survey.labels =</span> T)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /> Here we see that Bray-Curtis dissimilarity responds linearly to the proposed sequence of community dynamics. To confirm this geometry, we can calculate the geometric properties of the trajectory (i.e. length, angle between consecutive segments and overall directionality):</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">trajectoryLengths</span>(D,sites,surveys)</span></code></pre></div>
<pre><code>##     S1   S2   S3 Trajectory
## 1 0.15 0.15 0.15       0.45</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">trajectoryAngles</span>(D,sites,surveys)</span></code></pre></div>
<pre><code>##   S1-S2 S2-S3 mean sd rho
## 1     0     0    0  0   1</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">trajectoryDirectionality</span>(D,sites,surveys)</span></code></pre></div>
<pre><code>## 1 
## 1</code></pre>
<p>Angles are 0 degrees and overall directionality is maximum (i.e. 1), in accordance with the plot and the data. We now proceed to take the square root of the dissimilarity values, as would be necessary to achieve a metric (and Euclidean) space in a more complex data set:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>sqrtD <span class="ot">=</span> <span class="fu">sqrt</span>(D)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>sqrtD</span></code></pre></div>
<pre><code>##           1         2         3
## 2 0.3872983                    
## 3 0.5477226 0.3872983          
## 4 0.6708204 0.5477226 0.3872983</code></pre>
<p>The transformation increases all dissimilarity values (because the original values are smaller than 1), but the increase is larger for smaller values, so the ratio between large dissimilarities and small dissimilarities decreases. This has an effect on the overall shape of the trajectory, which surprisingly now looks like:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">trajectoryPCoA</span>(sqrtD,sites,surveys, <span class="at">survey.labels =</span> T)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>In addition to the distortion observed, the number of dimensions of the data have increased (i.e the sum of variance explained by the two axes is 88% &lt; 100%), so we cannot be sure that the angles are well represented. If we re-calculate the properties of the trajectory taking into account all dimensions we obtain:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">trajectoryLengths</span>(sqrtD,sites,surveys)</span></code></pre></div>
<pre><code>##          S1        S2        S3 Trajectory
## 1 0.3872983 0.3872983 0.3872983   1.161895</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">trajectoryAngles</span>(sqrtD,sites,surveys)</span></code></pre></div>
<pre><code>##   S1-S2 S2-S3 mean sd rho
## 1    90    90   90  0   1</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">trajectoryAngles</span>(sqrtD,sites,surveys, <span class="at">all=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##   A1 A2 A3 A4 mean sd rho
## 1 90 90 90 90   90  0   1</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">trajectoryDirectionality</span>(sqrtD,sites,surveys)</span></code></pre></div>
<pre><code>##   1 
## 0.5</code></pre>
<p>The length of segments and the trajectory have increased, but all segments are of the same length, in agreement with the original trajectory. In contrast, the angles are now 90 degrees and the overall directionality has decreased substantially.</p>
</div>
<div id="effect-of-different-transformations-on-more-complex-trajectories" class="section level2">
<h2>3. Effect of different transformations on more complex trajectories</h2>
<p>Here we use simulated data to compare four transformation approaches:</p>
<ol style="list-style-type: decimal">
<li>Local transformation of semi-metric dissimilarities (such as the percentage difference) in every triplet when the triangle inequality is required. This is done by default in the CTA functions of package <code>vegclust</code>.</li>
<li>Global transformation of dissimilarities, using the square root.</li>
<li>Global transformation of dissimilarities by using Principal Coordinates Analysis (classical multidimensional scaling) with eigenvalue correction.</li>
<li>Global transformation of dissimilarities by using metric multidimensional scaling (metric MDS).</li>
</ol>
<p>We use simulated dynamics to build another trajectory with more species (20) and more time steps. We begin by setting the number of time steps (50) and the size of the community (50 individuals):</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>Nsteps <span class="ot">=</span> <span class="dv">50</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>CC <span class="ot">=</span> <span class="dv">50</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>Nreplace <span class="ot">&lt;-</span> CC<span class="sc">*</span><span class="fl">0.05</span></span></code></pre></div>
<p><code>Nreplace</code> is the number of individuals to be replaced each time step (5%). Now we define the initial community vector and the vector with the probabilities of offspring for each species according to some ecological conditions:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">67</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">0</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>poffspring <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.002</span>, <span class="fl">0.661</span> ,<span class="dv">0</span> ,<span class="dv">0</span>, <span class="fl">0.037</span>, <span class="fl">0.281</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.008</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.005</span>, <span class="fl">0.003</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span></code></pre></div>
<p>We can now simulate the dynamics by sequentially applying stochastic deaths and recruitment:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>Nsteps<span class="sc">+</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="fu">length</span>(x))</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>m[<span class="dv">1</span>, ] <span class="ot">=</span> x</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>Nsteps) {</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  pdeath <span class="ot">&lt;-</span>x<span class="sc">/</span><span class="fu">sum</span>(x) <span class="co">#Equal probability of dying</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  deaths<span class="ot">&lt;-</span><span class="fu">rmultinom</span>(<span class="dv">1</span>,Nreplace, pdeath)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">pmax</span>(x <span class="sc">-</span> deaths,<span class="dv">0</span>)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  offspring <span class="ot">=</span> <span class="fu">rmultinom</span>(<span class="dv">1</span>,Nreplace, <span class="fu">as.vector</span>(poffspring))</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> x <span class="sc">+</span> offspring</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  m[k<span class="sc">+</span><span class="dv">1</span>, ]<span class="ot">&lt;-</span>x</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Then we decide how frequently (with respect to the simulated step) a sample of the community is taken, here every four steps:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>Sj <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>,Nsteps<span class="sc">+</span><span class="dv">1</span>, <span class="at">by=</span><span class="dv">4</span>) <span class="co">#Sample every four steps</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>mj <span class="ot">&lt;-</span> m[Sj,]</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>surveys <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(Sj)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>sites <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">length</span>(Sj))</span></code></pre></div>
<p>Now we are ready to calculate the Bray-Curtis dissimilarity:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> vegan<span class="sc">::</span><span class="fu">vegdist</span>(mj,<span class="st">&quot;bray&quot;</span>)</span></code></pre></div>
<p>In this more complex trajectory, some triangles may not obey the triangle inequality (depending on the simulation). This can be inspected using function <code>is.metric</code>:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.metric</span>(D, <span class="at">tol=</span><span class="fl">0.0000001</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Deviations from a metric space, if they exist, will be small, so that local transformation of triangles will be very small.</p>
<p>Local transformations are not possible to display trajectories. When we plot the trajectory using function <code>trajectoryPCoA</code> the global transformation of principal coordinates analysis (PCoA) with negative eigenvalue correction is performed. This is fine to display trajectories, but has problems when measuring angular properties, as we will see.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>pcoa<span class="ot">&lt;-</span><span class="fu">trajectoryPCoA</span>(D, sites, surveys, <span class="at">selection=</span><span class="dv">1</span>,<span class="at">length=</span><span class="fl">0.1</span>, <span class="at">axes=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">survey.labels =</span> T)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>pcoaD <span class="ot">=</span> <span class="fu">dist</span>(pcoa<span class="sc">$</span>points)</span></code></pre></div>
<p>The trajectory has some twists derived from stochasticity in death and recruitment. Let’s now look at the square root of the Bray-Curtis dissimilarity:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>sqrtD <span class="ot">=</span> <span class="fu">sqrt</span>(D)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>pcoaSqrt <span class="ot">=</span> <span class="fu">trajectoryPCoA</span>(sqrtD, sites, surveys, <span class="at">selection=</span><span class="dv">1</span>,<span class="at">length=</span><span class="fl">0.1</span>, <span class="at">axes=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">survey.labels =</span> T)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Finally, we also transform dissimilarities using metric multidimensional scaling (mMDS), provided by package <code>smacof</code>:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> smacof<span class="sc">::</span><span class="fu">mds</span>(D, <span class="at">ndim =</span> <span class="fu">length</span>(Sj)<span class="sc">-</span><span class="dv">1</span>, <span class="at">type =</span> <span class="st">&quot;interval&quot;</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>mmdsD <span class="ot">&lt;-</span> <span class="fu">dist</span>(res<span class="sc">$</span>conf)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">trajectoryPlot</span>(res<span class="sc">$</span>conf, sites, surveys, <span class="at">selection=</span><span class="dv">1</span>,<span class="at">length=</span><span class="fl">0.1</span>, <span class="at">axes=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">survey.labels =</span> T)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>While the three plots look different, the differences are not striking (besides rotation issues). We can compare the stress of the global solutions:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>smacof<span class="sc">::</span><span class="fu">stress0</span>(D,pcoaSqrt<span class="sc">$</span>points, <span class="at">type=</span><span class="st">&quot;interval&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Call:
## smacof::stress0(delta = D, init = pcoaSqrt$points, type = &quot;interval&quot;)
## 
## Model: Symmetric SMACOF 
## Number of objects: 13 
## Stress-1 value: 0.064 
## Number of iterations: 0</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>smacof<span class="sc">::</span><span class="fu">stress0</span>(D,pcoa<span class="sc">$</span>points, <span class="at">type=</span><span class="st">&quot;interval&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Call:
## smacof::stress0(delta = D, init = pcoa$points, type = &quot;interval&quot;)
## 
## Model: Symmetric SMACOF 
## Number of objects: 13 
## Stress-1 value: 0.009 
## Number of iterations: 0</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>smacof<span class="sc">::</span><span class="fu">stress0</span>(D,res<span class="sc">$</span>conf, <span class="at">type=</span><span class="st">&quot;interval&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Call:
## smacof::stress0(delta = D, init = res$conf, type = &quot;interval&quot;)
## 
## Model: Symmetric SMACOF 
## Number of objects: 13 
## Stress-1 value: 0.011 
## Number of iterations: 0</code></pre>
<p>Where we see that the square root leads to the strongest alteration of original dissimilarities. If we calculate geometric properties we are not limited by ordination plots and we can take into account all dimensions.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>anglesD <span class="ot">=</span> <span class="fu">trajectoryAngles</span>(D,sites,surveys)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>anglesSqrtD <span class="ot">=</span> <span class="fu">trajectoryAngles</span>(sqrtD,sites,surveys)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>anglesPcoaD <span class="ot">=</span> <span class="fu">trajectoryAngles</span>(pcoaD,sites,surveys)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>anglesmmdsD <span class="ot">=</span> <span class="fu">trajectoryAngles</span>(mmdsD,sites,surveys)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(<span class="fu">rbind</span>(anglesD, anglesSqrtD, anglesPcoaD, anglesmmdsD))</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(df)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;local&quot;</span>, <span class="st">&quot;global.sqrt&quot;</span>, <span class="st">&quot;global.pcoa&quot;</span>, <span class="st">&quot;global.mmds&quot;</span>)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(df,<span class="dv">2</span>)</span></code></pre></div>
<pre><code>##             S1-S2  S2-S3  S3-S4 S4-S5 S5-S6 S6-S7 S7-S8 S8-S9 S9-S10 S10-S11
## local       58.14  83.62  75.52  0.00  0.00  0.00  0.00  0.00   0.00    0.00
## global.sqrt 96.77 103.63 101.78 90.00 90.00 90.00 90.00 90.00  90.00   90.00
## global.pcoa 91.72 101.34 104.25 92.31 85.43 95.38 97.87 97.87 101.22  101.22
## global.mmds 66.07  92.59  88.05 45.92 29.68 46.46 49.74 32.07  37.88   60.25
##             S11-S12  mean   sd  rho
## local          0.00 17.55 0.58 0.85
## global.sqrt   90.00 92.92 0.09 1.00
## global.pcoa  101.22 97.26 0.09 1.00
## global.mmds   60.55 55.14 0.35 0.94</code></pre>
<p>The first call to <code>trajectoryAngles</code> with matrix <code>D</code> represents the default strategy of transforming triangles locally, which involves the weakest transformation of all and can be taken as reference. Both the square root and PCoA with negative eigenvalue correction induce a strong transformation of trajectory angles. The global solution of metric MDS leads to angles that are more similar to those of the local transformation strategy.</p>
<p>If we inspect the overall directionality, the global solution of metric MDS provides a value that is again closer to that of local transformation, compared to PCoA and the square root:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">trajectoryDirectionality</span>(D,sites,surveys)</span></code></pre></div>
<pre><code>##         1 
## 0.8699016</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">trajectoryDirectionality</span>(sqrtD,sites,surveys)</span></code></pre></div>
<pre><code>##         1 
## 0.4879245</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">trajectoryDirectionality</span>(pcoaD,sites,surveys)</span></code></pre></div>
<pre><code>##         1 
## 0.5769957</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">trajectoryDirectionality</span>(mmdsD,sites,surveys)</span></code></pre></div>
<pre><code>##         1 
## 0.7757694</code></pre>
</div>
<div id="conclusions" class="section level2">
<h2>4. Conclusions</h2>
<p>In this small study we compared the effect of different solutions to violation of the triangle inequality. If function <code>is.metric</code> returns TRUE for a given data set one should not worry about violations of the triangle inequality. Local solutions are those that imply the smallest number of changes, but these will not be consistent across triplets, so users may desire to apply a global transformation that produces euclidean spaces. This should be done with care. We have shown how the square root transformation distorts the angles and overall directionality of trajectories on the space defined by the percentage difference (alias Bray-Curtis) dissimilarity index. We suspect that this negative effect of square root transformation on angles happens no matter which coefficient is used to derive the initial distance matrix. Therefore, we advocate for avoiding its use when conducting community trajectory analysis (in particular for angles). The global transformation consisting in the application of PCoA with negative eigenvalue correction is less strong than the square root, but it still strongly change the angles between segments. Perhaps, the less harmful global transformation is provided by metric Multidimensional Scaling, but the need to embed distances in an Euclidean space of all three transformations implies a stronger requirement than being a metric, and results in distortions.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
